import requests as rq
import json

# Declaring variables
headers = {
    'x-api-key': '0TvQnueqKa5mxJntVWt0w4LpLfEkrV1Ta8rQBb9Z'
}

# You can get list of match IDs from schedule.py
matchIDs = ['107417059263300159', '107417059263300165', '107417059263300141', '107417059263300119',
            '107417059263300171',
            '107417059263365741', '107417059263365715', '107417059263300145', '107417059263300123',
            '107417059263365733',
            '107417059263300155', '107417059263300175', '107417059263300131', '107417059263300139',
            '107417059263365739',
            '107417059263300157', '107417059263300167', '107417059263365737', '107417059263300117',
            '107417059263365713',
            '107417059263365735', '107417059263300151', '107417059263300129', '107417059263300143',
            '107417059263365729',
            '107417059263300173', '107417059263300153', '107417059263365725', '107417059263365719',
            '107417059263300133',
            '107417059263300135', '107417059263300169', '107417059263431353', '107417059263365753',
            '107417059263365775',
            '107417059263365785', '107417059263365791', '107417059263365773', '107417059263431343',
            '107417059263431349',
            '107417059263365747', '107417059263365789', '107417059263365745', '107417059263365767',
            '107417059263431367',
            '107417059263365797', '107417059263431341', '107417059263365743', '107417059263431363',
            '107417059263431339',
            '107417059263431361', '107417059263365777', '107417059263365765', '107417059263365757',
            '107417059263431365',
            '107417059263365783', '107417059263365793', '107417059263431355', '107417059263365755',
            '107417059263365769',
            '107417059263365799', '107417059263365779', '107417059263431357', '107417059263365751',
            '107417059263431347',
            '107417059263365763', '107417059263365787', '107417059263365771', '107417059263365749',
            '107417059263431359',
            '107417059263365781', '107417059263365801', '107417059263431351', '107417059263365759',
            '107417059263431345',
            '107417059263365761', '107417059263365795', '107417293272826572', '107417293272826578',
            '107417293272826584']

# GETTING GAME IDs

# API endpoint to get specific game ID
# getEventDetails = 'https://esports-api.lolesports.com/persisted/gw/getEventDetails'
#
# parameters = {
#     'hl': 'en-US',
#     'id': ''
# }
#
# gameIDs = []
#
# for x in matchIDs:
#     parameters['id'] = x
#
#     data = rq.get(getEventDetails, params=parameters, headers=headers)
#     data = data.json()
#     data = data['data']['event']['match']['games']
#     gameID = data[0]['id']
#     gameIDs.append(gameID)
#
# print(gameIDs)

gameIDs = ['107417059263300160', '107417059263300166', '107417059263300142', '107417059263300120', '107417059263300172',
           '107417059263365742', '107417059263365716', '107417059263300146', '107417059263300124', '107417059263365734',
           '107417059263300156', '107417059263365712', '107417059263300132', '107417059263300140', '107417059263365740',
           '107417059263300158', '107417059263300168', '107417059263365738', '107417059263300118', '107417059263365714',
           '107417059263365736', '107417059263300152', '107417059263300130', '107417059263300144', '107417059263365730',
           '107417059263300174', '107417059263300154', '107417059263365726', '107417059263365720', '107417059263300134',
           '107417059263300136', '107417059263300170', '107417059263431354', '107417059263365754', '107417059263365776',
           '107417059263365786', '107417059263365792', '107417059263365774', '107417059263431344', '107417059263431350',
           '107417059263365748', '107417059263365790', '107417059263365746', '107417059263365768', '107417059263431368',
           '107417059263365798', '107417059263431342', '107417059263365744', '107417059263431364', '107417059263431340',
           '107417059263431362', '107417059263365778', '107417059263365766', '107417059263365758', '107417059263431366',
           '107417059263365784', '107417059263365794', '107417059263431356', '107417059263365756', '107417059263365770',
           '107417059263365800', '107417059263365780', '107417059263431358', '107417059263365752', '107417059263431348',
           '107417059263365764', '107417059263365788', '107417059263365772', '107417059263365750', '107417059263431360',
           '107417059263365782', '107417059263431338', '107417059263431352', '107417059263365760', '107417059263431346',
           '107417059263365762', '107417059263365796', '107417293272826573', '107417293272826579', '107417293272826585']

# GETTING GAME DATA

# API endpoint to get game data
getMatchDetails = 'https://feed.lolesports.com/livestats/v1/window/'

parameters = {
    'hl': 'en-US',
    'startingTime': '2022-05-04T02:50:00.000Z'
}

for x in gameIDs:
    print('processing ' + str(x))
    getMatchDetailsSpecificGame = getMatchDetails + str(x)

    data = rq.get(getMatchDetailsSpecificGame, params=parameters, headers=headers)
    data = data.json()

    metadata = data['gameMetadata']
    frame = data['frames'][-1]

    output_data = metadata
    output_data.update(frame)

    name = str(x) + '.json'
    with open(name, 'w') as outfile:
        json.dump(output_data, outfile)
